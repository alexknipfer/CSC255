R0	EQU	0
R1	EQU	1
R2	EQU	2
R3	EQU	3
R4	EQU	4
R5	EQU	5
R6	EQU	6
R7	EQU	7
R8	EQU	8
R9	EQU	9
R10	EQU	10
R11	EQU	11
R12	EQU	12
R13	EQU	13
R14	EQU	14
R15	EQU	15
PROG6	CSECT
	USING	PROG6,R15
*
	STM	R14,R12,12(R13)
	BAL	R14,80(R15)
	DS	18F
	ST	R13,4(R14)
	ST	R14,8(R13)
	LR	R13,R14
*
*
*** BUILD TABLE #1
*
	LA	R2,TABLE1
	BAL	R14,BUILDTAB	BRANCH TO BUILD TABLE ROUTINE
	ST	R3,ENDTAB1
*
*** PRINT TABLE #1
*
	XPRNT	=C'0    TABLE ONE VALUES'
	BAL	R14,PRINTTAB	BRANCH TO PRINT TABLE ROUTINE
*
*** BUILD TABLE #2
*
	LA	R2,TABLE2
	BAL	R14,BUILDTAB
	ST	R3,ENDTAB2
*
*** PRINT TABLE #2
*
	XPRNT	=C'0    TABLE TWO VALUES'
	BAL	R14,PRINTTAB
*
*** FIND DUPLICATES
*
	LA	R2,TABLE1
	LA	R3,TABLE2
	LA	R4,TABLE3
	L	R5,ENDTAB1
	L	R6,ENDTAB2
	BAL	R14,FINDDUP	BRANCH TO DUPLICATE ROUTINE
*
*** PRINT NEW TABLE
*
	XPRNT	=C'0    DUPLICATE TABLE VALUES'
	LA	R2,TABLE3
	LR	R3,R7
	BAL	R14,PRINTTAB
*
*** EXIT TO THE SYSTEM
	L	R13,4(R13)
	LM	R14,R12,12(R13)
	BR	R14
*
	LTORG
*
***** STORAGE AREA
*
ENDTAB1	DS	F
ENDTAB2	DS	F
TABLE1	DS	25F
TABLE2	DS	25F
TABLE3	DS	25F
*
******************************************************
*           TITLE 'BUILDTAB ROUTINE'                 *
******************************************************
BUILDTAB	DS	0H
	STM	R4,R2,READSAVE
*
*
****** GET NUMBER ****
*
	XREAD	CARD,80
	XDECI	R4,CARD
*
**** LAST? **
*
READLOOP	C	R4,=F'0'
	BE	SETLAST
*
**** PUT NUMBER IN TABLE ****
	ST	R4,0(R2)
	LA	R2,4(R2)
*
***** GET NEXT NUMBER *****
	XREAD	CARD,80
	XDECI	R4,CARD
	B	READLOOP
*
****** SET POINTER TO END OF TABLE ***
*
SETLAST	LR	R3,R2
	S	R3,=F'4'
*
***** RETURN TO CALLING ROUTINE
*
	LM	R4,R2,READSAVE
	BR	R14
*
	LTORG
*
****** BUILDTAB STORAGE AREA ******
CARD	DS	CL80
READSAVE	DS	15F
*
**************************************************
*     TITLE 'PRINTTAB ROUTINE'                   *
**************************************************
*
PRINTTAB	DS	0H
	STM	R0,R15,PRNTSAVE
*
***** CHECK FOR END OF TABLE
*
PRINTLP	CR	R2,R3
	BH	PRINTEND
*
****** PRINT ONE TABLE ENTRY *****
*
	L	R0,0(R2)
	XDECO	R0,PLINE
	XPRNT	PLINE-1,13
*
****** INCREMENT THE TABLE POINTER
*
	LA	R2,4(R2)
	B	PRINTLP
*
****** EXIT
*
PRINTEND	DS	0H
*	XPRNT	=C'0 ',2
	LM	R0,R15,PRNTSAVE
	BR	R14
*
	LTORG
*
***** PRINTTAB STORAGE AREA
*
	DC	C' '
PLINE	DS	CL12
PRNTSAVE	DS	16F
*
********************************************
*     TITLE 'FINDDUP ROUTINE'              *
********************************************
*
FINDDUP	DS	0H
	STM	R8,R6,DUPSAVE
*
***** END OF TABLE?
*
	LA	R9,TABLE2
	L	R0,0(R2)
	L	R1,0(R3)
*
END	CR	R2,R5
	BE	DONE
CMP	CR	R0,R1
	BE	FOUND
	LA	R3,4(R3)
	L	R1,0(R3)
	CR	R3,R6
	BE	NEW
	B	CMP
*
NEW	LA	R2,4(R2)
	L	R0,0(R2)
	LA	R3,0(R9)
*	B	END
	B	CMP
*
FOUND	ST	R0,0(R4)
	LA	R4,4(R4)
	LA	R2,4(R2)
	L	R0,0(R2)
	LA	R3,0(R9)
	B	END
*
DONE	ST	R0,4(R4)
	LR	R7,R4
	S	R7,=F'4'
	LM	R8,R6,DUPSAVE
	BR	R14
*
**********DUPSAVE STORAGE AREA
*
DUPSAVE	DS	15F
	END	PROG6
$ENTRY	DATA6.TXT
